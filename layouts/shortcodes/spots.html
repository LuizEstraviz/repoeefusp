<style>
  #map { width: 100%; height: 400px; }
</style>

<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
  crossorigin="">
<div id="map">
<script
  src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
  crossorigin=""></script>
<script>
  // JSON-encode your data
  const markers = JSON.parse({{ $.Site.Data.spots | jsonify }});

  const map = L.map('map');
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution:
      '&copy; <a href="https://www.openstreetmap.org/copyright">OSM</a> contributors'
  }).addTo(map);

  const bounds = [];
  markers.forEach(m => {
    L.marker([m.latitude, m.longitude])
      .addTo(map)
      .bindPopup(m.name);
    bounds.push([m.latitude, m.longitude]);
  });
  map.fitBounds(bounds);
</script>
</div>

<!-- 
<style>
  #map { width: 100%; height: 400px; }
</style>

<div id="map">
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" crossorigin="">
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" crossorigin=""></script>
<script>
  let markers = {{ $.Site.Data.spots | jsonify }};
</script>
<script src='{{ "js/map.js" | relURL }}'></script>
</div>
-->